function peticionAJAX(e,t){var a=new XMLHttpRequest;document.querySelector(".loader-content").style.display="flex",a.onreadystatechange=function(){if(4===a.readyState){if(a.status>=100&&a.status<=300){var i=JSON.parse(a.responseText);t(i)}else console.error("ERROR AJAX! en",e,JSON.parse(a.responseText));document.querySelector(".loader-content").style.display="none"}},a.open("GET",e,!0),a.send()}function addPlaylist(e,t){playlistList="",e.forEach(function(e,t){playlistList+='<li class="playlist__item play-preview" data-id="'+e.id+'" data-preview="'+e.previewURL+'"><div class="playlist__item__image"><img src="'+e.imageAlbum+'"></div><div class="playlist__item__title"><p class="name">'+e.name+'</p><p class="album">'+e.album+'</p></div><div class="playlist__item__buttons play-pause"><i class="fa fa-play" aria-hidden="true"></i></div><div class="playlist__item__buttons"><button data-id="'+e.id+'" class="delete-button"><i class="fa fa-trash-o" aria-hidden="true"></i></button></div></div></li>'}),playlistItems.innerHTML=playlistList,0!=t&&(smallModal.open(),smallModal.setContent("The track is added"))}function deleteItemPlaylist(e){var t=[];itemsToPlaylist.forEach(function(e,a){t.push(e.id)}),audioObject&&audioObject.getAttribute("data-id")===e&&audioObject.pause();var a=t.indexOf(e);tracksToPlaylist.splice(a,1),itemsToPlaylist.splice(a,1),addPlaylist(itemsToPlaylist,!1),window.localStorage.setItem("playListStorage",JSON.stringify(itemsToPlaylist)),0===itemsToPlaylist.length&&(listName.setAttribute("disabled",!1),createPlaylistButton.setAttribute("disabled",!1),listName.value="")}function resetPlaylist(){playListStorage=[],itemsToPlaylist=[],tracksToPlaylist=[],window.localStorage.clear()}function createPlaylist(e){playlistName=e.value;var t=new XMLHttpRequest;t.open("POST","/playlist"),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify({name:playlistName,tracksToAdd:tracksToPlaylist})),modalPlaylist.setContent("<p>The list has been created in your profile</p>"),modalPlaylist.open()}function toggleMenu(){pageWrap.classList.toggle("off"),mask.classList.toggle("show")}function printUserPlaylists(e,t){var a;void 0===t?t="myUser":a=t;peticionAJAX("/apiPlaylists/dataPlaylists?user="+t,function(i){var s=(i=JSON.parse(i)).items;if("myUser"===t&&(a=i.userName),0===s.length){var l=new tingle.modal({});l.open(),l.setContent("This user dont have playlists")}else{itemsList="<option data-selector='index-option'>Select your playlist</option>",s.forEach(function(e,t){itemsList+="<option id="+e.id+" data-user="+e.ownerId+">"+e.name+"</option>"});var n="#"+e+" .c-combo-box",o="#"+e+" .user-name";document.querySelector(n).innerHTML=itemsList,document.querySelector(o).innerHTML=a,"AreaContentMixOne"===e?(arrayMixOne=[],areaMixOne.innerHTML="",listaTemasArray=[],watchEmptyMixlists()):"AreaContentMixTwo"===e&&(arrayMixTwo=[],areaMixTwo.innerHTML="",listaTemasArray=[],watchEmptyMixlists())}})}function PrintPlaylist(e,t,a){listaTemasArray=[],peticionAJAX("/apiListsTracks/:datatracks?id="+t+"&user="+a,function(t){var a="";return(t=JSON.parse(t)).items.forEach(function(e,t){a+='<li class="mix-list__item play-preview" title="play" data-id="'+e.id+'" data-preview="'+e.previewURL+'"><div class="mix-list__title"><p><span class="txt-bold">'+e.artist+"</span> / "+e.name+'</p></div><div class="mix-list__buttons"><button><i class="fa fa-play" aria-hidden="true"></i></button></div></li>',listaTemasArray.push(e)}),e.innerHTML=a,a="",e===areaMixOne?arrayMixOne=listaTemasArray:e===areaMixTwo&&(arrayMixTwo=listaTemasArray),watchEmptyMixlists(),listaTemasArray})}function reloadMixArea(e,t){null!=e.options[e.selectedIndex].getAttribute("id")?PrintPlaylist(t,e.options[e.selectedIndex].getAttribute("id"),e.options[e.selectedIndex].getAttribute("data-user")):e===comboMixOne?(arrayMixOne=[],areaMixOne.innerHTML="",listaTemasArray=[],watchEmptyMixlists()):e===comboMixTwo&&(arrayMixTwo=[],areaMixTwo.innerHTML="",listaTemasArray=[],watchEmptyMixlists())}function watchEmptyMixlists(){0!=arrayMixOne.length&&0!=arrayMixTwo.length?(addMoreWrap.classList.remove("hide"),mixPlaylistsButton.classList.remove("disabled")):(addMoreWrap.classList.add("hide"),mixPlaylistsButton.classList.add("disabled"))}function arrayRandom(e){for(var t,a,i=e.length;i;t=parseInt(Math.random()*i),a=e[--i],e[i]=e[t],e[t]=a);return e}function changeUser(e){areaMixChange=e,console.log(areaMixChange),modalUser.setContent(modalUserContent),modalUser.open(),document.querySelector(".tingle-modal .change-user-input").addEventListener("keyup",function(e){userNameValue=this.value,0!=this.value?(changeUserButton.classList.remove("disabled"),13!=e.which&&13!=e.keyCode||(printUserPlaylists(areaMixChange,userNameValue),changeUserButton.classList.add("disabled"),modalUser.close())):changeUserButton.classList.add("disabled")})}var audioObject=null,mainApp=document.getElementById("mainApp"),pageWrap=document.getElementById("pageWrap"),mask=document.getElementById("mask");mainApp.addEventListener("click",function(e){var t=e.target;if(null!==t&&t.classList.contains("play-preview")){if("null"===t.getAttribute("data-preview"))return smallModal.open(),void smallModal.setContent("This track dont have audio preview");if(t.classList.contains("playing"))audioObject.pause();else{audioObject&&audioObject.pause();var a=t.getAttribute("data-preview");(audioObject=new Audio(a)).play(),audioObject.setAttribute("data-id",t.getAttribute("data-id")),t.classList.add("playing"),t.querySelector(".fa").classList.add("fa-pause"),t.querySelector(".fa").classList.remove("fa-play"),t.setAttribute("title","pause track"),t.parentNode.classList.add("active"),audioObject.addEventListener("ended",function(){t.classList.remove("playing"),t.querySelector(".fa").classList.remove("fa-pause"),t.querySelector(".fa").classList.add("fa-play"),t.setAttribute("title","play track"),t.parentNode.classList.remove("active")}),audioObject.addEventListener("pause",function(){t.classList.remove("playing"),t.querySelector(".fa").classList.remove("fa-pause"),t.querySelector(".fa").classList.add("fa-play"),t.setAttribute("title","play track"),t.parentNode.classList.remove("active")})}}});var smallModal=new tingle.modal({closeMethods:["overlay","button","escape"],cssClass:["modal--add-track"],onOpen:function(){window.setTimeout(function(){smallModal.close()},1e3)}}),tracksToPlaylist=[],itemsToPlaylist=[],playlistName="new playlist",playlistList="",itemsList="",playlistItems=document.getElementById("playlistItems"),createPlaylistButton=document.getElementById("playlistAdd"),addMoreWrap=document.getElementById("addMoreWrap");playlistItems.addEventListener("click",function(e){var t=e.target;t.classList.contains("delete-button")&&deleteItemPlaylist(t.getAttribute("data-id"))}),listName.addEventListener("keyup",function(e){0!=this.value?(createPlaylistButton.removeAttribute("disabled"),13!=e.which&&13!=e.keyCode||createPlaylist(listName)):createPlaylistButton.setAttribute("disabled",!1)}),createPlaylistButton.addEventListener("click",function(e){createPlaylist(listName)});var modalPlaylist=new tingle.modal({closeMethods:[],footer:!0,stickyFooter:!0});modalPlaylist.addFooterBtn("NEW PLAYLIST","c-button tingle-btn",function(){resetPlaylist(),playlistItems.innerHTML="",pageWrap.classList.contains("search-page")?(itemsSearchResults.innerHTML="",addMoreButton.style.display="none"):pageWrap.classList.contains("mix-page")&&(arrayMixOne=[],areaMixOne.innerHTML="",listaTemasArray=[],comboMixOne.selectedIndex="0",arrayMixTwo=[],areaMixTwo.innerHTML="",listaTemasArray=[],comboMixTwo.selectedIndex="0",watchEmptyMixlists()),listName.value="",listName.setAttribute("disabled",!1),createPlaylistButton.setAttribute("disabled",!1),audioObject&&audioObject.pause(),modalPlaylist.close()}),modalPlaylist.addFooterBtn("CONTINUE","c-button tingle-btn",function(){modalPlaylist.close()});var playListStorage=[];(window.localStorage=0!=window.localStorage.length)&&(playListStorage=JSON.parse(window.localStorage.getItem("playListStorage")),addPlaylist(itemsToPlaylist=playListStorage,!1),itemsToPlaylist.forEach(function(e,t){tracksToPlaylist.push(e.URItrack)}),0===itemsToPlaylist.length?listName.setAttribute("disabled",!1):listName.removeAttribute("disabled")),document.getElementById("toggleNav").addEventListener("click",function(e){toggleMenu()}),document.getElementById("closeNav").addEventListener("click",function(e){toggleMenu()}),mask.addEventListener("click",function(e){toggleMenu()}),document.getElementById("primaryNav").addEventListener("click",function(){resetPlaylist()});var areaMixOne=document.getElementById("areaMixOne"),areaMixTwo=document.getElementById("areaMixTwo"),areaMixFinal=document.getElementById("areaMixFinal"),comboMixOne=document.getElementById("comboMixOne"),comboMixTwo=document.getElementById("comboMixTwo"),mixPlaylistsButton=document.getElementById("mixPlaylistsButton"),playlistItemsMix=document.getElementById("playlistItemsMix"),arrayMixOne=[],arrayMixTwo=[],listaTemasArray=[];printUserPlaylists("AreaContentMixOne"),printUserPlaylists("AreaContentMixTwo"),comboMixOne.addEventListener("change",function(){reloadMixArea(this,areaMixOne),arrayMixOne=listaTemasArray}),comboMixTwo.addEventListener("change",function(){reloadMixArea(this,areaMixTwo),arrayMixTwo=listaTemasArray}),mixPlaylistsButton.addEventListener("click",function(){smallModal.open(),smallModal.setContent("The Playlist is mixed"),tracksToPlaylist=[],(itemsToPlaylist=arrayRandom(arrayMixOne.concat(arrayMixTwo))).forEach(function(e,t){tracksToPlaylist.push(e.uri)}),addPlaylist(itemsToPlaylist,!1),window.localStorage.setItem("playListStorage",JSON.stringify(itemsToPlaylist)),listName.removeAttribute("disabled")});var modalUser=new tingle.modal({closeMethods:[],footer:!0,stickyFooter:!0});modalUser.addFooterBtn("Close","c-button tingle-btn",function(){changeUserButton.classList.add("disabled"),modalUser.close()}),modalUser.addFooterBtn("Change user","c-button tingle-btn btn-change-user disabled",function(){printUserPlaylists(areaMixChange,userNameValue),changeUserButton.classList.add("disabled"),modalUser.close()}),modalUser.addFooterBtn("Select my user","c-button tingle-btn",function(){printUserPlaylists(areaMixChange),changeUserButton.classList.add("disabled"),modalUser.close()});var userNameValue,changeUserButtonOne=document.getElementById("changeUserButtonOne"),changeUserButtonTwo=document.getElementById("changeUserButtonTwo"),modalUserContent=document.querySelector(".tingle-user-content").innerHTML,changeUserButton=document.querySelector(".btn-change-user");changeUserButtonOne.addEventListener("click",function(){changeUser(this.getAttribute("data-area"))}),changeUserButtonTwo.addEventListener("click",function(){changeUser(this.getAttribute("data-area"))});var areaMixChange;