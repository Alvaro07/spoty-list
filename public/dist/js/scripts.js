function peticionAJAX(e,t){var a=new XMLHttpRequest;document.querySelector(".loader-content").style.display="flex",a.onreadystatechange=function(){if(4===a.readyState){if(a.status>=100&&a.status<=300){var s=JSON.parse(a.responseText);t(s)}else console.error("ERROR AJAX! en",e,JSON.parse(a.responseText));document.querySelector(".loader-content").style.display="none"}},a.open("GET",e,!0),a.send()}function cleanSearch(){itemsList="",itemsSearchResults.innerHTML=itemsList}function addItemsSearch(e){peticionAJAX("/apiSearch/data?keyword="+encodeURIComponent(e)+"&offset="+numOffset+"&searchType="+searchType,function(t){var a=(t=JSON.parse(t)).items;if(0===a.length){var s=new tingle.modal({onOpen:function(){searchInput.blur()},beforeClose:function(){this.destroy(),searchInput.value=""}});s.open(),s.setContent("No matches found")}else e!=searchWord&&(searchWord=e,cleanSearch()),a.forEach(function(e,t){itemsList+='<li class="c-item-box"><div class="c-item-box__img"><img src="'+e.imageAlbum+'" data-preview="'+e.previewUrl+'" class="cover" data-id="'+e.id+'"><div class="actions"><a title="play track"><i class="fa fa-play" aria-hidden="true"></i></a><a data-uri="'+e.URITrack+'" data-id="'+e.id+' title="play track"><i class="fa fa-plus" aria-hidden="true"></i></a></div></div><div class="c-item-box__text"><p class="title">'+e.name+'</p><p class="subtitle">'+e.album+"</p></div></li>"}),itemsSearchResults.innerHTML=itemsList,10!=a.length&&addMoreWrap.classList.remove("hide"),a.length<8&&addMoreWrap.classList.add("hide")})}function searchSpoty(){if(""!=searchInput.value)cleanSearch(),addItemsSearch(searchInput.value.trim());else{var e=new tingle.modal({cssClass:["modal--error-search"],onOpen:function(){searchInput.blur()},beforeClose:function(){this.destroy()}});e.open(),e.setContent("The search is empty")}}var itemsList,searchWord,numOffset=0,searchButton=document.getElementById("searchButton"),searchInput=document.getElementById("searchField"),addMoreButton=document.getElementById("addMoreButton"),addMoreWrap=document.getElementById("addMoreWrap"),itemsSearchResults=document.getElementById("searchResults"),searchTypeCombo=document.getElementById("searchType"),searchType=searchTypeCombo.options[searchTypeCombo.selectedIndex].getAttribute("data-id");searchTypeCombo.addEventListener("change",function(){searchType=searchTypeCombo.options[searchTypeCombo.selectedIndex].getAttribute("data-id")}),searchInput.addEventListener("keypress",function(e){13!=e.which&&13!=e.keyCode||searchSpoty()}),searchButton.addEventListener("click",function(e){searchSpoty()}),addMoreButton.addEventListener("click",function(e){numOffset+=8,addItemsSearch(searchWord)});